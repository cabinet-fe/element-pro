@use 'mixins/mixins' as *;

@mixin shadow($offsetX) {
  box-shadow: $offsetX 0 10px -10px #ddd inset;
  content: '';
  position: absolute;
  top: 0px;
  width: 10px;
  bottom: -1px;
  overflow-x: hidden;
  overflow-y: hidden;
  touch-action: none;
  pointer-events: none;
}

@include b(data-table) {
  background-color: var(--el-bg-color-overlay);
  color: var(--el-text-color-regular);
  border: 1px solid #eee;
  font-size: 14px;

  table {
    table-layout: fixed;
    border-spacing: 0;
    border-collapse: collapse;
    min-width: 100%;
    width: 100%;
  }

  th,
  td {
    padding: 0;
    & > div {
      padding: 0 4px;
    }
  }

  // 表头
  @include e(header-wrap) {
    will-change: scroll-position;

    @include when(resizing) {
      cursor: col-resize;
    }
  }

  @include e(header) {
    background-color: #fff;
    user-select: none;
    &-wrap {
      width: 100%;
      overflow: hidden;
    }
  }

  @include e(column-resize) {
    position: absolute;
    height: 100%;
    width: 4px;
    top: 0;
    cursor: col-resize;
    z-index: 1;
    box-sizing: border-box;

    &:hover {
      border-right: 4px dotted #ccc;
    }
  }

  @include e(header-cell) {
    border-bottom: 1px solid #eee;
    box-shadow: -1px 0px 0px 0px #eee inset;
    box-sizing: border-box;
    background-color: #f8f8f8;

    & > div {
      width: 100%;
      word-break: break-all;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    &--left,
    &--right {
      position: sticky;
      z-index: 1;
    }

    &--center {
      @include when(leaf) {
        position: relative;
      }
    }

    &--right {
      @include when(first) {
        box-shadow: 1px 0px 0px 0px #eee inset;
      }
    }
  }

  // 表体
  @include e(body) {
  }

  @include e(row) {
    &:hover {
      td {
        background-color: var(--el-fill-color-light);
      }
    }
  }

  @include e(cell) {
    box-shadow: -1px -1px 0px 0px #eee inset;
    & > div {
      word-break: break-all;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      width: 100%;
    }

    &--left,
    &--right {
      position: sticky;
      z-index: 1;
      background-color: var(--el-bg-color);
    }

    &--left {
      @include when(last) {
      }
    }

    &--right {
      @include when(first) {
        & > div {
          border-left: 1px solid #eee;
        }
      }
    }

    &--center {
      @include when(last) {
        & > div {
          border-right: none;
        }
      }
    }
  }

  // 合计行
  @include e(footer-wrap) {
    overflow: hidden;
    will-change: scroll-position;
  }

  @include e(footer-cell) {
    box-shadow: -1px 0px 0px 0px #eee inset;

    & > div {
      width: 100%;
      word-break: break-all;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    &--left,
    &--right {
      position: sticky;
      z-index: 1;
      background-color: var(--el-bg-color);
    }
  }

  // 左固定栏阴影
  @include when(left-fixed-shadow) {
    .el-data-table__header-cell,
    .el-data-table__cell,
    .el-data-table__footer-cell {
      &--left.is-last::after {
        @include shadow(10px);
        right: -10px;
      }
    }
  }

  // 右固定栏阴影
  @include when(right-fixed-shadow) {
    .el-data-table__header-cell,
    .el-data-table__cell,
    .el-data-table__footer-cell {
      &--right.is-first::before {
        @include shadow(-10px);
        left: -10px;
      }
    }
  }
}
