<template>
  <el-card style="width: 50%">
    <el-table-select
      v-model="singleData"
      :columns="columns"
      :data="tableData"
      :multiple="false"
      pagination
      :show-index="true"
      :query="query"
      dialog-title="弹框标题"
      ref="tableRef"
      :editable="true"
      :table="true"
      value-key="project"
      :path="path"
      @update:model-value="handleChange"
    >
      <el-button type="primary" :icon="Plus">自定义按钮</el-button>

      <template #searcher>
        <el-input v-model="query.name" />
        <el-input v-model="query.name" />
        <el-input v-model="query.name" />
        <el-input v-model="query.name" />
        <el-date-picker v-model="query.$date" clearable />
      </template>

      <template #action>
        <el-button type="primary" @click="handleClick">详情</el-button>
      </template>
    </el-table-select>
  </el-card>

  <!-- <el-table :data="tableData" style="width: 100%">
    <el-table-column prop="date" label="Date" name="Date" />
    <el-table-column prop="name" label="Name" name="Name" />
    <el-table-column prop="address" label="Address" name="Address" />
  </el-table> -->
</template>

<script lang="ts" setup>
import { shallowReactive, shallowRef, onMounted } from 'vue'
import type { ProTableColumn } from 'element-ultra'
import { Plus } from '@element-plus/icons-vue'

// const columns = $ref([
//   { key: 'name', name: '名字' },
//   { key: 'date', name: '日期' },
//   { key: 'address', name: '地址' }
// ])
const columns: ProTableColumn[] = $ref([
  {
    key: 'code',
    name: '明细指标编码',
    width: 160,
    render: (_, __, v) => {
      return v?.substring(0, 8) || null
    }
  },
  { key: 'summary', name: '摘要' },
  { key: 'project', name: '项目' },
  {
    key: 'status',
    name: '状态'
  },
  { key: 'remarks', name: '备注' },
  { key: 'department', name: '部门', width: 160 },
  {
    key: 'frozenAmount',
    name: '当前已冻结金额(元)',
    width: 150
  },
  {
    key: 'balance',
    name: '可冻结金额(元)',
    width: 130
  },
  {
    key: 'newForzenAmount',
    name: '本次冻结金额(元)',
    width: 140
  },
  { key: 'frozenRemark', name: '冻结备注' },
  { key: 'action', name: '操作', slot: 'column-action' }
])

let singleData = $ref({})

let multipleData = $ref([{ id: '1517846945443110913' }, { id: '1519595040521015296' }])

let multiple = $ref<boolean>(true)

const tableData = $ref([
  {
    amount: 1000000,
    balance: 999978,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: null,
    code: 'Q20220422000002',
    createTime: '2022-04-22 20:12:35',
    creator: 'jiang',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: null,
    deleted: false,
    department: '元和测试',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1419849528110092290',
    deptOrgCode: 'YHCS',
    expendItems: null,
    frozenAmount: 0,
    functionalSubjects: null,
    functionalSubjectsName: null,
    fundsType: '经费类型2',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1517476464433061889',
    latestAmount: 999978,
    modifier: 'cl',
    modifyTime: '2022-05-09 15:23:21',
    orgCode: 'YHCS',
    parentId: '1517445719555596290',
    paymentMethod: null,
    paymentMethodName: null,
    personalContacts: null,
    planId: '1517363462526492674',
    planLevel: 'second',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: null,
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: null,
    used: true,
    years: null
  },
  {
    amount: 1000000,
    balance: 1000000,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: null,
    code: 'Q20220423000001',
    createTime: '2022-04-23 20:44:50',
    creator: 'jiang',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: null,
    deleted: false,
    department: '元和测试',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1419849528110092290',
    deptOrgCode: 'YHCS',
    expendItems: null,
    frozenAmount: 0,
    functionalSubjects: null,
    functionalSubjectsName: null,
    fundsType: '经费类型2',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1517846945443110913',
    latestAmount: 1000000,
    modifier: null,
    modifyTime: null,
    orgCode: 'YHCS',
    parentId: '1517445719555596290',
    paymentMethod: null,
    paymentMethodName: null,
    personalContacts: null,
    planId: '1517363462526492674',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: null,
    reviewStatus: 'draft',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: null,
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '5345353453452',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  },
  {
    amount: 100,
    balance: 0,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '5102',
    code: 'Q20220428000008',
    createTime: '2022-04-28 16:31:05',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: 'local',
    deleted: false,
    department: '81771899 娄葑街道徐家浜社区居民委员会',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '1427508719440236545',
    deptOrgCode: '817718-81771899',
    expendItems: '5201 投资收益',
    frozenAmount: 0,
    functionalSubjects: '外交支出',
    functionalSubjectsName: '外交支出',
    fundsType: '0101 人员经费',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '1519595040521015296',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '5345353453451',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: 'enable',
    summary: 'test',
    used: false,
    years: null
  }
])

const query = shallowReactive({
  name: '',
  $date: ''
})

const tableRef = shallowRef()

const handleClick = () => {
  let obj = {
    amount: 123,
    balance: 123,
    budgetType: null,
    capitalNature: null,
    capitalNatureName: null,
    capitalSource: null,
    capitalSourceName: null,
    classOrgCode: '123',
    code: '123',
    createTime: '123',
    creator: 'cl',
    custom1: null,
    custom2: null,
    custom3: null,
    custom4: null,
    dataSource: '123',
    deleted: false,
    department: '123',
    departmentEconomics: null,
    departmentEconomicsName: null,
    deptId: '123',
    deptOrgCode: '123-123',
    expendItems: '123 123',
    frozenAmount: 123,
    functionalSubjects: '123',
    functionalSubjectsName: '123',
    fundsType: '0101 123',
    fundsTypeName: null,
    governmentEconomics: null,
    governmentEconomicsName: null,
    id: '123',
    latestAmount: 0,
    modifier: 'cl',
    modifyTime: '2022-05-07 14:39:09',
    orgCode: '817718-81771899',
    parentId: '-1',
    paymentMethod: '直接支付',
    paymentMethodName: null,
    personalContacts: null,
    planId: '1519233722672697344',
    planLevel: 'first',
    project: '534535345345',
    projectClassification: null,
    projectClassificationName: null,
    projectName: null,
    quotaProject: '534535345345',
    quotaSource: null,
    quotaSourceName: null,
    quotaSymbol: null,
    remarks: 'test',
    reviewStatus: 'checked',
    settlementMethod: null,
    settlementMethodName: null,
    status: '改变',
    summary: 'asd',
    used: false,
    years: null
  }

}

let path = $ref('')

const handleChange = (data: any) =>  {
  path = '/page-play'
}


onMounted(() => {
  setTimeout(() => {
    Object.assign(singleData, { frozenRemark: 'ttttttttttt' })
  }, 3000)
},)
</script>
